/* Side-by-side Layout (Image Left, Text Right) */

/* --- Layout & Panes --- */
/* Ensure the main container accounts for the fixed navbar */
#container {
    padding-top: 0 !important;
    position: relative;
    height: calc(100vh - 50px);
    /* Subtract Navbar Height */
    width: 100vw;
    overflow: hidden;
    margin-top: 0;
}

/* Status Bar full width at top */
#statusBar {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 30px;
    z-index: 100;
}


/* New Full Text Side-Car Pane */
/* New Full Text Side-Car Pane */
#full-text-pane {
    position: absolute;
    top: 50px;
    /* Matched to Navbar Height */
    left: 50%;
    /* Start at midpoint */
    width: 50% !important;
    /* Take other half */
    height: calc(100vh - 100px);
    /* Account for 50px Header + 50px Footer */
    background-color: #f0f0f0;
    /* Matched to Image Pane */
    border-left: 1px solid #ccc;
    overflow-y: auto;
    padding: 10px;
    /* Internal padding only */
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    z-index: 1500;
    display: flex !important;
    /* Enable Flex for Centering */
    flex-direction: column;
}

/* Content Container for Scroll/Center */
#sidecar-content {
    width: 100%;
    margin-top: auto;
    margin-bottom: auto;
}

/* Individual Line Editors */
.line-editor {
    display: block;
    width: 100%;
    min-height: 1.2em;
    padding: 4px 8px 4px 40px;
    /* Indent 20px extra (blockquote style) */
    margin-bottom: 0;
    background-color: white;
    /* Use transparent borders to reserve space and prevent shifts */
    border: 1px solid transparent;
    border-radius: 0;
    color: #333;
    font-size: 15px;
    line-height: 1.5;
    transition: background 0.1s ease;
    /* Animate background only to prevent jumps */
    cursor: text;
}

.line-editor:hover {
    /* Match the active line width constraint (70%) but use the new theme color */
    background: linear-gradient(to right, #e0e0e0 70%, white 70%);
}

.line-editor:focus {
    outline: none !important;
    background-color: #fff;
    /* Ensure absolutely NO blue border/shadow on focus */
    border-color: transparent !important;
    box-shadow: none !important;
    z-index: 10;
    position: relative;
}

/* Active Line (Synced with Image Selection) */
.line-editor.active-line {
    /* 70% Width Red Highlight via Gradient */
    background: linear-gradient(to right, #ffcdd2 70%, white 70%);

    /* Border Removed per request */
    border-left: none !important;

    /* MAINTAIN transparent borders to prevent height shift! */
    border-top: 1px solid transparent !important;
    border-bottom: 1px solid transparent !important;
    border-right: 1px solid transparent !important;
}

/* SVG Selection Styling Override */
svg .selected,
svg .highlight,
.TextLine.selected .Unicode,
g.selected path,
g.selected polyline,
g.selected polygon {
    stroke: #ff0000 !important;
    /* Brighter Red */
    stroke-width: 3px !important;
    stroke-opacity: 1 !important;
    fill: rgba(255, 0, 0, 0.1) !important;
}

/* Make default blue lines more subtle without affecting hover */
/* Targeting the base geometric elements */
.TextLine polygon,
.TextLine polyline,
.TextLine path {
    stroke-opacity: 0.2 !important;
    /* Even subtler */
    /* If they are blue by default, this makes them faint blue */
}

/* Ensure Hover/Selected is distinct */
.TextLine:hover polygon,
.TextLine:hover polyline,
.TextLine:hover path {
    stroke-opacity: 0.8 !important;
    /* Restore opacity on hover */
    stroke-width: 2px !important;
}

/* Override any other visibility rules for #textedit */
#container:not(.hide-text-edit) #textedit {
    display: block !important;
    z-index: 1600;
    background: white;
    border-top: 2px solid #ccc;
    height: 45px !important;
    bottom: 0;
    top: auto;
    left: 50% !important;
    width: 50% !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
    white-space: nowrap;
    overflow-x: auto;
    padding: 5px;
    line-height: 25px;
}

/* --- Global Resets for Layout --- */
body,
html {
    margin: 0;
    padding: 0;
    height: 100vh;
    overflow: hidden;
}

#statusBar {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    flex-wrap: nowrap !important;
    white-space: nowrap !important;
    height: 50px !important;
    background-color: #e0e0e0;
    /* Darker grey for contrast */
    border-bottom: 1px solid #ccc;
    /* Slightly darker border */
    padding: 0 15px !important;
    box-sizing: border-box;
    width: 100% !important;
    position: absolute !important;
    /* Fixed at top */
    top: 0;
    left: 0;
    z-index: 9999 !important;
    /* Force on top */
    visibility: visible !important;
    /* Prevent hiding */
    opacity: 1 !important;
    /* Prevent hiding */
}

/* Force inner containers to behave as flex rows, preventing stacking */
#statusBar .navbar-header,
#statusBar .navbar-brand,
#statusBar .container-fluid,
#statusBar .collapse {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    float: none !important;
    margin: 0 !important;
    width: auto !important;
}

/* Hide unwanted elements */
#textFilter,
#selectedType,
#selectedId,
#modeElement,
#modeActive,
span#modeActive {
    display: none !important;
    visibility: hidden !important;
}

/* Page Controls Group */
#prevPage,
#nextPage,
#pageNumWrap {
    display: inline-block;
    vertical-align: middle;
}

#pageNumWrap {
    margin: 0 2px;
    /* Reduced from 10px to match zoom buttons */
    padding-right: 5px;
    /* Add requested padding after total pages */
    display: inline-flex;
    align-items: center;
    vertical-align: middle;
    height: 22px;
    /* Match button height */
    line-height: 22px;
    order: 4;
}

#pageNum {
    width: 40px;
    text-align: center;
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 0 5px;
    /* Reduced vertical padding */
    height: 22px;
    line-height: 20px;
    /* Account for borders */
    margin-right: 2px;
    /* Reduced from 5px */
    vertical-align: middle;
}

#totPages {
    vertical-align: middle;
    line-height: 22px;
}

/* Zoom Controls Group (Injected by JS) */
#zoomControls {
    display: inline-flex;
    align-items: center;
    margin-left: 20px;
    /* Space between File info and Zoom */
    vertical-align: middle;
}

#zoomControls button {
    margin: 0 2px;
    padding: 2px 8px;
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 3px;
    cursor: pointer;
    font-weight: bold;
}

#zoomControls button:hover {
    background: #e6e6e6;
}

/* Force SVG to fill container explicitly */
#xpg svg {
    width: 100% !important;
    height: 100% !important;
    max-width: none !important;
    max-height: none !important;
    display: block !important;
}

/* Image Pane (Left) */
#xpg {
    position: absolute !important;
    top: 50px !important;
    /* Below Navbar */
    left: 0 !important;
    width: 50% !important;
    height: calc(100vh - 100px) !important;
    /* Account for 50px Header + 50px Footer */
    overflow: hidden !important;
    z-index: 10;
    margin: 0 !important;
    background-color: #f0f0f0;
    /* Default background */
    border-right: 1px solid #ccc;
    display: flex !important;
    justify-content: center !important;
    /* Center image */
    align-items: center !important;
    /* Center vertically */
}

/* Force SVG to be behave as an image block that can be aligned */
#xpg svg {
    display: block !important;
    width: 100% !important;
    /* Restore 100% width */
    height: 100% !important;
    /* Fill height */
    max-width: 100% !important;
    /* Remove auto-margin hacks */
}

.hide-text-edit #textedit {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
}

/* EXPLODE REMOVED: Stabilize layout first.
   Image stays 50% even if text is hidden. */
#container.hide-text-edit #xpg {
    width: 50% !important;
    border-right: 2px solid #ccc;
}

/* Hide the unwanted right sidebar panes completely */
#sidebar,
#textinfo {
    display: none !important;
}

/* Hide the "Lower pane" toggle in the menu? 
   NO, we need this because the user might have accidentally hidden it. 
   We just need to ensure the label is clear if we could, but CSS can't rename it easily.
   Let's just unhide it.
*/
#hide-text-edit {
    display: block !important;
}

/* Ensure drawer (menu) is on top and behaves as an overlay */
#drawer {
    z-index: 2000;
    position: absolute;
    top: 30px;
    /* Below status bar */
    left: 60%;
    /* Explicitly start at 60% to occupy right 40% */
    width: 40% !important;
    height: calc(100vh - 30px);
    overflow-y: auto;
    background: white;
    border-left: 1px solid #ccc;
}

/* Allow the close button (if any) to be seen */
#drawerButton {
    z-index: 2001;
}

/* --- REFINED NAVIGATION BAR STYLING --- */

/* 1. Hide unwanted elements */
/* Hide ALL native info elements inside stateInfo (garbage wrapper, mode indicators) */
#stateInfo>* {
    display: none !important;
}

/* Restore ONLY the custom filename element */
#stateInfo #xmlFile {
    display: inline-block !important;
    font-weight: normal;
    margin: 0 10px;
    float: none !important;
    position: static !important;
    color: #333;
}

/* Hamburger Menu (Keep on far right) */
#drawerButton {
    /* Existing class usually handles float/pos, but flex item behavior overrides it */
    margin-left: 0 !important;
    order: 10;
}

/* Fix Editor Layout to account for Fixed Header if needed (but currently relative) */
#container {
    padding-top: 0 !important;
    /* Reset any padding */
}

/* 5. Custom Page Label (Added via JS, styled here) */
.custom-page-label {
    margin-right: 5px;
    color: #888;
    font-size: 14px;
}

/* 6. Page Controls Styling - Match Zoom Buttons */
/* 6. Page Controls Styling - Match Zoom Buttons (Bootstrap btn-default look) */
#prevPage,
#nextPage {
    cursor: pointer;
    margin: 1px 3px 1px 4px;
    /* User specified spacing */
    padding: 2px 8px;
    /* Match btn-sm padding */
    color: #333;
    background-color: #fff;
    border: 1px solid #e0e0e0;
    /* Lighter border per request */
    font-weight: normal;
    /* Bootstrap isn't usually bold */
    border-radius: 3px;
    font-size: 12px;
    height: 22px;
    /* Adjust for border */
    line-height: 16px;
    vertical-align: middle;
    display: inline-block;
}

#prevPage:hover,
#nextPage:hover {
    background-color: #e6e6e6;
    border-color: #adadad;
}

#pageNum {
    margin: 0 5px;
}

#pageInput {
    color: black;
    height: 20px;
    font-size: 12px;
    text-align: center;
    border: none;
    border-radius: 2px;
}

/* 7. Zoom Controls (Injected) */
.custom-zoom-group {
    /* margin-left: 15px; Removed spacing as order handles it */
    display: inline-flex;
    align-items: center;
}

.custom-zoom-label {
    margin-right: 5px;
    color: #888;
}

/* Update this to target the injected buttons explicitly */
#zoomControls button {
    margin: 1px 5px 1px 5px;
    /* User specified spacing */
    padding: 2px 8px;
    color: #333;
    background: #fff;
    font-weight: normal;
    cursor: pointer;
    border: 1px solid #e0e0e0;
    /* Lighter border per request */
    border-radius: 3px;
    font-size: 12px;
    height: 22px;
    line-height: 16px;
}

#zoomControls button:hover {
    background: #e6e6e6;
    border-color: #adadad;
}

/* --- CONTROL GROUPS BORDER STYLING --- */
#zoomControls,
#pageControlsGroup {
    border: 1px solid #aaa;
    /* Reverted to lighter grey */
    border-radius: 4px;
    padding: 3px 5px;
    /* Spacing inside the group border */
    display: inline-flex;
    align-items: center;
    background-color: #f2f2f2;
    /* Reduced by ~2 shades (light grey) */
    /* Or slight grey if desired */
    margin: 0 5px;
    /* Spacing between groups */
}

/* --- FLEX ORDERING FOR NAVBAR --- */
/* Target Order: [Zoom] [File Info] [Page Controls] */

/* 1. Zoom Controls (Injected) */
#zoomControls {
    order: 1;
    margin-right: 20px;
    /* Space after Zoom */
}

/* 2. File Info (Container) */
#stateInfo {
    order: 2;
    margin-right: 20px;
    /* Space after File */
}

/* 3. Page Controls Group (Wrapped) */
#pageControlsGroup {
    order: 3;
}

/* Reset individual orders just in case */
#prevPage,
#pageNumWrap,
#nextPage {
    order: 0;
}

/* 4. Hamburger Menu (Far Right) */
#drawerButton {
    position: absolute !important;
    right: 10px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    z-index: 2001 !important;
    /* Ensure it stays on top */
    float: none !important;
}

/* 8. Hamburger Menu (Settings) - Keep Right */
/* Bootstrap .navbar-toggle is usually float: right. 
   We need to ensure it stays right even with our Flexbox header.
   Flexbox 'margin-left: auto' pushes it to the right. */
.navbar-toggle {
    padding: 9px 10px;
    /* Bootstrap default adjustment */
    border: none;
    z-index: 200;
}

/* TEST: Target bottom footer area */
#textedit {
    background-color: #e0e0e0 !important;
    /* Darker grey for contrast */
    border-top: 1px solid #ccc !important;
    /* Match header border style */
}

/* TEST: Fill the gap under the image pane */
body {
    background-color: #e0e0e0 !important;
}

/* Hide Cursor Coordinates in Footer */
#cursor {
    display: none !important;
}

/* Fix Drawer Menu Occlusion */
#drawer {
    top: 50px !important;
    /* Push below the 50px header */
    height: calc(100% - 50px) !important;
    /* Adjust height to fit */
    z-index: 9000 !important;
    /* High, but typically below header if desired, or above? 
                                 Usually drawer overlays everything. 
                                 User said "don't put it over the top navbar", so it should respect top:50px. */
}

/* --- Spinner for Update PDF --- */
.spinner {
    display: inline-block;
    width: 12px;
    height: 12px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
    margin-right: 5px;
    vertical-align: middle;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* Update PDF Button Customizations */
.btn-update-pdf-custom {
    font-size: 14px !important;
    padding: 6px 16px !important;
    font-weight: 600 !important;
    min-width: 140px !important;
    text-align: center !important;
}

/* btn-update-success removed - using native btn-success */